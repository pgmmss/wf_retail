-*DM_JOB_TYPE=8192
-*DM_REQ_DESC=Custom Copy Merge Example
-*-----------------------------------------------------------------------------------*
-* Copyright (c) Information Builders, Inc. All rights reserved. @MFSM_NOPROLOG@
-*-----------------------------------------------------------------------------------*
ENGINE INT SET TABLESAMPLING_PERCENTAGE
ENGINE INT SET FCA ON
TABLE FILE app02/wf_retail_lite
 PRINT
   COGS_LOCAL
   COGS_US
   DISCOUNT_LOCAL
   DISCOUNT_US
   GROSS_PROFIT_LOCAL
   GROSS_PROFIT_US
   MSRP_LOCAL
   MSRP_US
   QUANTITY_SOLD
   REVENUE_LOCAL
   REVENUE_US
   BY WF_RETAIL_TIME_SALES.TIME_YEAR
   BY WF_RETAIL_TIME_SALES.TIME_QTR
   BY WF_RETAIL_TIME_SALES.TIME_MTH
   BY WF_RETAIL_SALES.ID_SALES
 ON TABLE SET PARTITIONING PARALLEL
 ON TABLE SET HOLDATTRS CUBE
 ON TABLE SET EMPTYREPORT ON
 ON TABLE SET SHORTPATH SQL
 ON TABLE MERGE INTO FILE app02/test/wfr_sales_extract
  MATCHING TRG.TIME_YEAR EQ SRC.TIME_YEAR AND TRG.TIME_QTR EQ SRC.TIME_QTR AND TRG.TIME_MTH EQ SRC.TIME_MTH AND TRG.ID_SALES EQ SRC.ID_SALES;
   WHEN MATCHED UPDATE
    COGS_LOCAL=SRC.COGS_LOCAL;
    COGS_US=SRC.COGS_US;
    DISCOUNT_LOCAL=SRC.DISCOUNT_LOCAL;
    DISCOUNT_US=SRC.DISCOUNT_US;
    GROSS_PROFIT_LOCAL=SRC.GROSS_PROFIT_LOCAL;
    GROSS_PROFIT_US=SRC.GROSS_PROFIT_US;
    MSRP_LOCAL=SRC.MSRP_LOCAL;
    MSRP_US=SRC.MSRP_US;
    QUANTITY_SOLD=SRC.QUANTITY_SOLD;
    REVENUE_LOCAL=SRC.REVENUE_LOCAL;
    REVENUE_US=SRC.REVENUE_US;
   WHEN NOT MATCHED INSERT
    TIME_YEAR=SRC.TIME_YEAR;
    TIME_QTR=SRC.TIME_QTR;
    TIME_MTH=SRC.TIME_MTH;
    ID_SALES=SRC.ID_SALES;
    COGS_LOCAL=SRC.COGS_LOCAL;
    COGS_US=SRC.COGS_US;
    DISCOUNT_LOCAL=SRC.DISCOUNT_LOCAL;
    DISCOUNT_US=SRC.DISCOUNT_US;
    GROSS_PROFIT_LOCAL=SRC.GROSS_PROFIT_LOCAL;
    GROSS_PROFIT_US=SRC.GROSS_PROFIT_US;
    MSRP_LOCAL=SRC.MSRP_LOCAL;
    MSRP_US=SRC.MSRP_US;
    QUANTITY_SOLD=SRC.QUANTITY_SOLD;
    REVENUE_LOCAL=SRC.REVENUE_LOCAL;
    REVENUE_US=SRC.REVENUE_US;
 HEADING
  "Report &FOCFOCEXEC"
 WHERE MSRP_US FROM 1500 TO 2499;
END
